  0%|          | 0/15625000 [00:00<?, ?it/s]
{'loss': 208.07199096679688, 'l2_loss': 189.09713745117188, 'l1_loss': 18.97486114501953}
3.587886333465576 9.086715698242188 9.984342575073242
14.03%
Reconstruction: (0.14033190299844026, 3.587886333465576, 9.086715698242188, 9.984342575073242)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0., device='cuda:0')
{'loss': 41.771400451660156, 'l2_loss': 26.60757827758789, 'l1_loss': 15.163822174072266}
{'loss': 39.508628845214844, 'l2_loss': 20.28127670288086, 'l1_loss': 19.22735023498535}
{'loss': 21.711715698242188, 'l2_loss': 10.481176376342773, 'l1_loss': 11.23054027557373}
{'loss': 22.421344757080078, 'l2_loss': 10.755369186401367, 'l1_loss': 11.665976524353027}
{'loss': 18.91842269897461, 'l2_loss': 8.597570419311523, 'l1_loss': 10.32085132598877}
{'loss': 16.760883331298828, 'l2_loss': 7.487525939941406, 'l1_loss': 9.273357391357422}
{'loss': 15.645903587341309, 'l2_loss': 6.456576347351074, 'l1_loss': 9.189327239990234}
{'loss': 14.48404312133789, 'l2_loss': 5.785146236419678, 'l1_loss': 8.698897361755371}
{'loss': 13.597864151000977, 'l2_loss': 5.457311630249023, 'l1_loss': 8.140552520751953}
{'loss': 12.236303329467773, 'l2_loss': 4.2782416343688965, 'l1_loss': 7.958062171936035}
3.6570446491241455 3.7953529357910156 10.022058486938477
97.83%
Reconstruction: (0.9782705442295844, 3.6570446491241455, 3.7953529357910156, 10.022058486938477)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.0026, device='cuda:0')
{'loss': 11.489961624145508, 'l2_loss': 4.066090106964111, 'l1_loss': 7.423871040344238}
{'loss': 12.086971282958984, 'l2_loss': 4.1360626220703125, 'l1_loss': 7.950908660888672}
{'loss': 11.290811538696289, 'l2_loss': 4.029773235321045, 'l1_loss': 7.261038780212402}
{'loss': 10.160202026367188, 'l2_loss': 3.4146409034729004, 'l1_loss': 6.745560646057129}
{'loss': 9.972152709960938, 'l2_loss': 3.3338851928710938, 'l1_loss': 6.638267993927002}
{'loss': 9.926554679870605, 'l2_loss': 3.282775402069092, 'l1_loss': 6.643779277801514}
{'loss': 9.285870552062988, 'l2_loss': 3.1191627979278564, 'l1_loss': 6.166707515716553}
{'loss': 9.259943008422852, 'l2_loss': 2.9566774368286133, 'l1_loss': 6.30326509475708}
{'loss': 9.34958553314209, 'l2_loss': 2.7673630714416504, 'l1_loss': 6.5822224617004395}
{'loss': 8.995359420776367, 'l2_loss': 2.860825777053833, 'l1_loss': 6.134533882141113}
3.780979871749878 3.8846466541290283 10.18809700012207
98.38%
Reconstruction: (0.983820058178726, 3.780979871749878, 3.8846466541290283, 10.18809700012207)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.0696, device='cuda:0')
{'loss': 9.055571556091309, 'l2_loss': 2.8401479721069336, 'l1_loss': 6.215423583984375}
{'loss': 9.083718299865723, 'l2_loss': 3.097663402557373, 'l1_loss': 5.98605489730835}
{'loss': 8.40458869934082, 'l2_loss': 2.6311464309692383, 'l1_loss': 5.773441791534424}
{'loss': 7.998049259185791, 'l2_loss': 2.5800795555114746, 'l1_loss': 5.417969703674316}
{'loss': 8.400144577026367, 'l2_loss': 2.696470022201538, 'l1_loss': 5.703674793243408}
{'loss': 8.102267265319824, 'l2_loss': 2.5729000568389893, 'l1_loss': 5.529366970062256}
{'loss': 8.034682273864746, 'l2_loss': 2.4813740253448486, 'l1_loss': 5.553308486938477}
{'loss': 7.519876003265381, 'l2_loss': 2.2472634315490723, 'l1_loss': 5.272612571716309}
{'loss': 8.053451538085938, 'l2_loss': 2.5635828971862793, 'l1_loss': 5.489868640899658}
{'loss': 7.8558030128479, 'l2_loss': 2.545045852661133, 'l1_loss': 5.310757160186768}
3.776087999343872 3.845829486846924 10.098498344421387
98.90%
Reconstruction: (0.9889691614911786, 3.776087999343872, 3.845829486846924, 10.098498344421387)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.1111, device='cuda:0')
{'loss': 8.1288423538208, 'l2_loss': 2.4408798217773438, 'l1_loss': 5.687962532043457}
{'loss': 7.6952290534973145, 'l2_loss': 2.4673895835876465, 'l1_loss': 5.227839469909668}
{'loss': 7.481761455535889, 'l2_loss': 2.31223726272583, 'l1_loss': 5.169524192810059}
{'loss': 8.041022300720215, 'l2_loss': 2.6652140617370605, 'l1_loss': 5.375808238983154}
{'loss': 7.392034530639648, 'l2_loss': 2.2737717628479004, 'l1_loss': 5.118262767791748}
{'loss': 7.302255630493164, 'l2_loss': 2.248401641845703, 'l1_loss': 5.053853988647461}
{'loss': 8.132438659667969, 'l2_loss': 2.5884320735931396, 'l1_loss': 5.54400634765625}
{'loss': 7.4461445808410645, 'l2_loss': 2.2418274879455566, 'l1_loss': 5.204317092895508}
{'loss': 7.215068340301514, 'l2_loss': 2.1943140029907227, 'l1_loss': 5.020754337310791}
{'loss': 7.518404960632324, 'l2_loss': 2.224792957305908, 'l1_loss': 5.293612003326416}
3.6901633739471436 3.754319429397583 9.952899932861328
98.98%
Reconstruction: (0.9897559070468769, 3.6901633739471436, 3.754319429397583, 9.952899932861328)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.1206, device='cuda:0')
{'loss': 7.558366298675537, 'l2_loss': 2.4557199478149414, 'l1_loss': 5.102646350860596}
{'loss': 7.294960975646973, 'l2_loss': 2.1797683238983154, 'l1_loss': 5.115192413330078}
{'loss': 7.222286224365234, 'l2_loss': 2.2383289337158203, 'l1_loss': 4.983957290649414}
{'loss': 7.726928234100342, 'l2_loss': 2.423332691192627, 'l1_loss': 5.303595542907715}
{'loss': 7.246016025543213, 'l2_loss': 2.2786478996276855, 'l1_loss': 4.967368125915527}
{'loss': 6.981886386871338, 'l2_loss': 2.062692165374756, 'l1_loss': 4.919194221496582}
{'loss': 7.083815574645996, 'l2_loss': 2.220733404159546, 'l1_loss': 4.863082408905029}
{'loss': 7.24539852142334, 'l2_loss': 2.1904265880584717, 'l1_loss': 5.054971694946289}
{'loss': 6.99052095413208, 'l2_loss': 2.0020346641540527, 'l1_loss': 4.988486289978027}
{'loss': 7.11976957321167, 'l2_loss': 2.1417274475097656, 'l1_loss': 4.978042125701904}
3.57384991645813 3.642378330230713 10.046979904174805
98.94%
Reconstruction: (0.9894134037316381, 3.57384991645813, 3.642378330230713, 10.046979904174805)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.1282, device='cuda:0')
{'loss': 6.753459930419922, 'l2_loss': 1.9450658559799194, 'l1_loss': 4.808393955230713}
{'loss': 6.960400104522705, 'l2_loss': 2.070578098297119, 'l1_loss': 4.889822006225586}
{'loss': 7.094048976898193, 'l2_loss': 2.275393486022949, 'l1_loss': 4.818655490875244}
{'loss': 7.221017360687256, 'l2_loss': 2.3162097930908203, 'l1_loss': 4.9048075675964355}
{'loss': 6.656156539916992, 'l2_loss': 1.9297572374343872, 'l1_loss': 4.7263994216918945}
{'loss': 6.548491954803467, 'l2_loss': 1.9473905563354492, 'l1_loss': 4.601101398468018}
{'loss': 6.69002628326416, 'l2_loss': 2.103294849395752, 'l1_loss': 4.586731433868408}
{'loss': 6.604870796203613, 'l2_loss': 1.943867564201355, 'l1_loss': 4.661003112792969}
{'loss': 6.952207565307617, 'l2_loss': 2.1852223873138428, 'l1_loss': 4.7669854164123535}
{'loss': 6.785196781158447, 'l2_loss': 2.1193060874938965, 'l1_loss': 4.665890693664551}
3.7636680603027344 3.833569049835205 10.210601806640625
98.92%
Reconstruction: (0.9891574828774722, 3.7636680603027344, 3.833569049835205, 10.210601806640625)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.1324, device='cuda:0')
{'loss': 6.73719596862793, 'l2_loss': 2.0704591274261475, 'l1_loss': 4.666736602783203}
{'loss': 6.822587013244629, 'l2_loss': 2.0701801776885986, 'l1_loss': 4.752407073974609}
{'loss': 6.545564651489258, 'l2_loss': 1.9657988548278809, 'l1_loss': 4.579765796661377}
{'loss': 6.740056991577148, 'l2_loss': 2.0297393798828125, 'l1_loss': 4.710317611694336}
{'loss': 6.696950912475586, 'l2_loss': 1.948007583618164, 'l1_loss': 4.748943328857422}
{'loss': 6.91416072845459, 'l2_loss': 2.19271183013916, 'l1_loss': 4.72144889831543}
{'loss': 6.683629989624023, 'l2_loss': 1.9475624561309814, 'l1_loss': 4.736067771911621}
{'loss': 6.346472263336182, 'l2_loss': 1.8922914266586304, 'l1_loss': 4.454180717468262}
{'loss': 6.516449451446533, 'l2_loss': 2.039252758026123, 'l1_loss': 4.47719669342041}
{'loss': 6.955166816711426, 'l2_loss': 2.160301446914673, 'l1_loss': 4.794865131378174}
3.842921018600464 3.905892848968506 10.39197063446045
99.04%
Reconstruction: (0.9903845849303781, 3.842921018600464, 3.905892848968506, 10.39197063446045)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.1510, device='cuda:0')
{'loss': 6.64302396774292, 'l2_loss': 2.102123260498047, 'l1_loss': 4.540900707244873}
{'loss': 6.534276962280273, 'l2_loss': 2.046515941619873, 'l1_loss': 4.4877610206604}
{'loss': 6.579286575317383, 'l2_loss': 2.104837656021118, 'l1_loss': 4.4744486808776855}
{'loss': 6.796619415283203, 'l2_loss': 2.104165554046631, 'l1_loss': 4.692453861236572}
{'loss': 6.604709148406982, 'l2_loss': 2.0580854415893555, 'l1_loss': 4.546623706817627}
{'loss': 6.6075263023376465, 'l2_loss': 1.9603619575500488, 'l1_loss': 4.647164344787598}
{'loss': 5.896268844604492, 'l2_loss': 1.7996342182159424, 'l1_loss': 4.096634864807129}
{'loss': 6.30329704284668, 'l2_loss': 1.8565186262130737, 'l1_loss': 4.446778297424316}
{'loss': 6.655183792114258, 'l2_loss': 2.0345094203948975, 'l1_loss': 4.6206746101379395}
{'loss': 6.465673446655273, 'l2_loss': 1.9559376239776611, 'l1_loss': 4.509735584259033}
3.8532028198242188 3.901536464691162 10.166790008544922
99.23%
Reconstruction: (0.9923445034617892, 3.8532028198242188, 3.901536464691162, 10.166790008544922)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.1452, device='cuda:0')
{'loss': 6.575812816619873, 'l2_loss': 2.0358986854553223, 'l1_loss': 4.539914131164551}
{'loss': 6.23137092590332, 'l2_loss': 1.947960615158081, 'l1_loss': 4.28341007232666}
{'loss': 6.5064287185668945, 'l2_loss': 1.9859776496887207, 'l1_loss': 4.520451068878174}
{'loss': 6.1760759353637695, 'l2_loss': 1.8673720359802246, 'l1_loss': 4.308703899383545}
{'loss': 6.362196445465088, 'l2_loss': 1.9368200302124023, 'l1_loss': 4.4253764152526855}
{'loss': 6.536394119262695, 'l2_loss': 1.98086416721344, 'l1_loss': 4.555530071258545}
{'loss': 6.304380416870117, 'l2_loss': 1.9086410999298096, 'l1_loss': 4.395739555358887}
{'loss': 6.641233444213867, 'l2_loss': 2.0813863277435303, 'l1_loss': 4.559847354888916}
{'loss': 6.126236915588379, 'l2_loss': 1.8485889434814453, 'l1_loss': 4.277647972106934}
{'loss': 6.241065979003906, 'l2_loss': 1.9235905408859253, 'l1_loss': 4.317475318908691}
3.5866191387176514 3.6451961994171143 9.886846542358398
99.07%
Reconstruction: (0.9907023894620672, 3.5866191387176514, 3.6451961994171143, 9.886846542358398)
  0%|          | 0/5 [00:00<?, ?it/s]
Num dead tensor(0.1666, device='cuda:0')
{'loss': 6.245019435882568, 'l2_loss': 1.921769618988037, 'l1_loss': 4.323249816894531}
{'loss': 6.593098163604736, 'l2_loss': 2.047708034515381, 'l1_loss': 4.5453901290893555}
{'loss': 6.439457893371582, 'l2_loss': 1.97027587890625, 'l1_loss': 4.469182014465332}
{'loss': 6.339935302734375, 'l2_loss': 1.9850752353668213, 'l1_loss': 4.354860305786133}
{'loss': 6.424818515777588, 'l2_loss': 2.0094637870788574, 'l1_loss': 4.4153547286987305}
{'loss': 6.1800031661987305, 'l2_loss': 1.8760881423950195, 'l1_loss': 4.303915023803711}
{'loss': 6.258902549743652, 'l2_loss': 1.9192721843719482, 'l1_loss': 4.339630126953125}
{'loss': 6.60359001159668, 'l2_loss': 2.08378005027771, 'l1_loss': 4.519809722900391}
{'loss': 6.375547409057617, 'l2_loss': 1.9827845096588135, 'l1_loss': 4.392763137817383}
{'loss': 6.3655290603637695, 'l2_loss': 1.978165864944458, 'l1_loss': 4.387362957000732}
3.7682647705078125 3.8282368183135986 10.15839672088623
99.06%
Reconstruction: (0.9906148968015857, 3.7682647705078125, 3.8282368183135986, 10.15839672088623)
  0%|          | 0/5 [00:00<?, ?it/s]
Saved as version 2
Traceback (most recent call last):
  File "/workspace/1L-Sparse-Autoencoder/train.py", line 37, in <module>
    freqs = get_freqs(5, local_encoder=encoder)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/workspace/1L-Sparse-Autoencoder/utils.py", line 325, in get_freqs
    tokens = all_tokens[torch.randperm(len(all_tokens))[:cfg["model_batch_size"]]]
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 1020, in __len__
    if self.dim() == 0:
KeyboardInterrupt
Traceback (most recent call last):
  File "/workspace/1L-Sparse-Autoencoder/train.py", line 37, in <module>
    freqs = get_freqs(5, local_encoder=encoder)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/workspace/1L-Sparse-Autoencoder/utils.py", line 325, in get_freqs
    tokens = all_tokens[torch.randperm(len(all_tokens))[:cfg["model_batch_size"]]]
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 1020, in __len__
    if self.dim() == 0:
KeyboardInterrupt